<!--
 * @Author: your name
 * @Date: 2021-07-14 10:54:12
 * @LastEditTime: 2021-08-13 15:14:06
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /my-training-doc/docs/git/index.md
-->
# DHC前端架构

## 目前线上项目的架构
### 设计
***子系统的集成***  

**应用级集成**  
a) 被集成应用子系统应提供其访问入口地址(URL),应用子系统需将用户、机构及身份认证纳入门户中进行管理,并根据各地具体业务要求,选择将角色、权限信息统一纳入到门户中进行管理或在应用子系统内部进行管理;  

b) 门户对用户帐号、组织机构信息维护,并负责用户身份的合法性验证,实现单点登录;  

c) 应用子系统应通过门户子系统提供的 API 服务获取已登录用户信息,并根据已登录用户信息进行数据权限和资源权限(包括菜单、功能、API)控制。  

[具体实现效果参考](http://172.16.1.187/dlybjcep/portal/#/)   
*账号： superAdmin*  
*密码： admin123*  

### 组件库  
::: tip DHC-UI简介
1. 基于Element UI二次封装的内部私有组件库  
2. UI符合国家局样式标准  
3. 支持*全局引入*和*按需引入*  
:::
[查看DHC-UI文档](http://42.202.134.229:8085/dhc/#/component/installation)

### 开发（子系统）
[本地开发说明](http://42.202.134.229:8085/dhc/#/home/subdev)

### 使用（门户系统）
[权限配置规则及流程](http://42.202.134.229:8085/dhc/#/home/permconf)  
[具体实现效果](http://172.16.1.187/dlybjcep/portal/#/baseinfo/menu) 
### demo演练（子系统集成）
::: tip 要求
1. 拉取[子系统项目模板](http://42.202.134.229:8083/hsaf/vue-health-subsystem-admin) develop分支, 单独copy一份  （未使用过DHC-UI的）
2. 使用DHC-UI开发一个订单增删改查的页面  （未使用过DHC-UI的）
3. [门户](http://172.16.1.187/dlybjcep/portal)配置子系统，菜单等权限实操  
:::

## 国家局下发的新架构
### 设计 
***子系统集成***  

**菜单级集成**  
a) 被集成应用子系统应提供功能页面地址(URL),支持多级菜单目录,页面只应包含工作区,不应包含菜单和 logo 等其他内容;被集成应用子系统页面应支持 iframe方式集成;  

b) 门户负责对组织机构、用户、角色、菜单等维护,并实现单点登录;  

c) 应用子系统应通过门户子系统提供的 API 服务获取已登录用户信息,并根据已登录用户信息进行数据权限控制。数据权限应取当前登录人所在机构的层级进行控制,应用子系统可以对具体功能模块的数据权限进行控制。  

**应用级集成**  
a) 被集成应用子系统应提供其访问入口地址(URL),应用子系统需将用户、机构及身份认证纳入门户中进行管理,并根据各地具体业务要求,选择将角色、权限信息统一纳入到门户中进行管理或在应用子系统内部进行管理;  

b) 门户对用户帐号、组织机构信息维护,并负责用户身份的合法性验证,实现单点登录;  

c) 应用子系统应通过门户子系统提供的 API 服务获取已登录用户信息,并根据已登录用户信息进行数据权限和资源权限(包括菜单、功能、API)控制。  

### 组件库  
没有官方组件库，各自实现

### 开发
**多页模式**  
特点：  
1. ***首屏渲染相对较快***  
2. 利于SEO  
3. 项目体量较大，开发配置繁琐  
4. 切换页面时，需要重新请求html，导致有些卡顿  

**单页模式**  
特点：
1. 项目较大时，首屏渲染相对较慢  
2. 不利于SEO  
3. ***项目目录结构比较简单清晰***  
4. ***切换页面流畅***  

**本地开发**  
A.单页（同一页面出两套，即纯内容页 和 带layout的内容页）  
***B.单页（根据top.location === location来判断是否是iframe, 然后渲染不同的layout）***  

### 使用
统一门户子系统的培训视频（第1包-内部统一门户子系统-用户培训）

### demo演练（子系统集成）
::: tip 要求
1. 拉取[子系统项目模板](http://42.202.134.229:8083/hsaf/vue-health-subsystem-admin) dev-for-iframe分支  
2. 在[门户](http://42.202.134.192:11211/#/home)配置子系统，菜单等权限实操   
:::
